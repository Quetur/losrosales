<header>
  <link rel="stylesheet" href="/css/verventas.css">
</header>

<body>
  <form id="verticket_remito" action="/verticket_afip" method="post" style="font-size:24px">


    <div class="row">
      <div class="col-sm-5 col-md-6">
        <!--<div class="container mt-3 " style="width:300px;" align="left">-->

        <table border=0 align="center">
          <tr>
            <td style="width:300px;  align-items: center; text-align: center;">
              <input style="width:300px;height: 70px;font-size: 2rem;" type="text" name="search" id="search"
                class="form-control" placeholder="buscar" />
            </td>

            </td>
          </tr>
        </table>
        <div class="d-flex  justify-content-center">
          <div class="col-md-12 mx-auto">

            <table border="1">
              <tr style="font-size: 1em; font-weight: bold; background-color: blue; color: white;">
                <td style="width: 107px;">Fecha</td>
                <td style="width: 80px;">Hora</td>
                <td style="width: 100px;">Numero</td>
                <td style="width: 250px;">Cliente</td>
                <td style="width: 100px;">Vendedor</td>
                <td style="width: 150px;">Tipo</td>
                <td style="width: 130px;">Total</td>
                <td style="width: 60px;"></td>
              </tr>
            </table>
            <div class="listaProductos">
              <table class="mi_table" id="tabla"> <!-- table table-striped table-bordered table-hover header-fixed -->

                <tbody>

                  {{#each ventas}}
                  <tr style="color:black;font-size:70%;">
                    <td style="width: 107px;text-align:right;">{{fecha_afip}}</td>
                    <td style="width: 80px;text-align:right;">&nbsp&nbsp{{hora_comp}}</td>
                    <td style="width: 100px;text-align:right;">&nbsp&nbsp{{nroCmp}}</td>
                    <td style="width: 100px;text-align:right;">{{id_pedido}}</td>
                    <td style="width: 250px;text-align:left;">&nbsp&nbsp{{cliente}}</td>
                    <td style="width: 100px;text-align:left;" hidden>&nbsp&nbsp{{tipoventa}}</td>
                    <td style="width: 100px;text-align:left;">&nbsp&nbsp{{vendedor}}</td>
                    <td style="width: 150px;text-align:left;">&nbsp&nbsp{{tipo}}</td>
                    <td style="width: 130px;text-align:right;">$&nbsp&nbsp{{total}}</td>
                    <td style="text-align:left;" hidden>{{caja}}</td>
                    <td style="text-align:left;">{{id}}</td>
                    <td style="text-align:center; ">
                      <button style="width: 50px;background-color:green;color:white; " class="verfactura" type="button"
                        id="{{id}}" value="{{id}}">V</button>
                    </td>
                    <input id="fecha_{{id}}" value="{{fecha}}" hidden> </input>
                    <input id="hora_{{id}}" value="{{Hora}}" hidden> </input>
                    <input id="cliente_{{id}}" value="{{cliente}}" hidden> </input>
                    <input id="vendedor_{{id}}" value="{{vendedor}}" hidden> </input>
                    <input id="tipoventa_{{id}}" value="{{tipoventa}}" hidden> </input>
                    <input id="total_{{id}}" value="{{total}}" hidden> </input>
                    <input id="condicion_{{id}}" value="{{caja}}" hidden> </input>
                    <input id="saldoant_{{id}}" value="{{saldoant}}" hidden> </input>
                    <input id="trans_{{id}}" value="{{trans}}" hidden> </input>
                  </tr>
                  {{/each}}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-5 col-md-6">
        <table border="0" style="height: 140px; font-size: 2rem; width: 1000px;">
          <tr>
            <td>
              <label type="text">vendedor</label>
              <input type="text" name="combo_prov" id="combo_prov" class="form-control"
                style="height: 70px;font-size: 2rem; text-align: left;" />
            </td>
            <td style="height: 20px;font-size: 2rem;width: 100px;  text-align: center;">
              <label type="text">t-venta</label>
              <input class="form-control" style="height: 70px;font-size: 2rem;  font-weight: bold;" type="text"
                name="tipodeventa" id="tipodeventa" class="form-control" readonly></input>
            </td>

            <td style="height: 20px;font-size: 2rem;width: 170px;  text-align: center;">
              <label type="text">Pago</label>
              <input class="form-control" style="height: 70px;font-size: 2rem;  font-weight: bold;" type="text"
                name="condicion" id="condicion" class="form-control" readonly></input>
            </td>
            <td style="height: 20px;font-size: 2rem;width: 170px;  text-align: center;">
              <input class="form-control" style="height: 70px;font-size: 2rem;  font-weight: bold;" type="text"
                name="cliente_saldo" id="cliente_saldo" class="form-control" hidden></input>
            </td>
          </tr>
          <tr>
            <td style="height: 20px;font-size: 2rem;width: 170px;  text-align: left;">
              <label type="text">Fecha</label>
              <input style="font-size: 2rem;width: 130px;  text-align: left;" name="fecha" id="fecha" readonly>
            </td>
            <td style="height: 20px;font-size: 2rem;width: 110px;  text-align: left;">
              <label type="text">Hora</label>
              <input style="font-size: 2rem;width: 80px;  text-align: left;" name="hora" id="hora" readonly>
            </td>
            <td style="height: 20px;font-size: 2rem;width: 130px;  text-align: left;">
              <label type="text">Numero </label>
              <input style="font-size: 2rem;width: 80px;  text-align: left;" name="factura" id="factura" readonly>
            </td>
            <td style="height: 20px;font-size: 2rem;width: 180px;  text-align: left;">
              <label type="text">Cliente</label>
              <input style="font-size: 2rem;width: 300px;  text-align: left;" name="cliente" id="cliente" readonly>
            </td>
        </table>


        <form>
          <div class="d-flex  justify-content-center">
            <div class="col-md-12 mx-auto">
              <div class="listaProductos">
                <!--  id="lista_compra" -->
                <table border="1" id="lista_compra" class="table table-striped table-bordered table-hover"
                  name="lista_compra">
                  <thead>
                    <tr style="color:black;font-size:80%;">
                      <th>Numero</th>
                      <th>Descripcion</th>
                      <th>Cant</th>
                      <th>Precio Unitario</th>
                      <th>Subttl</th>
                    </tr>
                  </thead>

                  <tbody id="prod_compra">
                    <span id="out"></span>
                    <!--  {{#each detalleventas}}


                      <tr style="color:black;font-size:70%;">
                        <td>{{id_remito}}</td>
                        <td>{{des}}</td>
                        <td id=style="text-align:right;">&nbsp&nbsp{{cant}}</td>
                        <td style="text-align:right;">&nbsp&nbsp{{precio_unit}}</td>
                        <td style="text-align:right;">&nbsp&nbsp{{venta}}</td>
                          <input id="desc_{{id_remito}}" value="{{des}}" hidden=false> </input>
                         <input id="costo_{{id_remito}}" value="{{cant}}" hidden=false> </input>
                        <input id="precio1_{{id_remito}}" value="{{precio_unit}}" hidden=false> </input>
                          <input id="venta_{{id_remito}}" value="{{venta}}" hidden=false> </input>
                      </tr>


                    {{/each}}-->
                  </tbody>
                </table>

              </div>
              <div>
                <table border=0 align="center">
                  <tr>
                    <td>
                      <label class="col-form-label h2">Items :</label>
                    </td>
                    <td>
                      <input style="width:100px;" class="btn btn-secondary btn-lg btn-block" name="largo" id="largo"
                        align="center">
                    </td>
                    <td style="width:100px;  align-items: right; text-align: right;">
                      <label class="col-form-label h2" style="width:300px;">Total de la Venta :</label>
                    </td>
                    <td style="width:100px;  align-items: right; text-align: right;">
                      <input style="width:100px;" align="center" class="btn btn-primary btn-lg btn-block" id="total"
                        name="total" class="total" value="" type="text" readonly> </input>
                    </td>
                  </tr>

                  <tr>

                    <td style="width:100px;  align-items: right; text-align: right;">

                    </td>
                    <td style="width:100px;  align-items: center; text-align: center;">

                    </td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>



                    <td style="width:100px;hight=100px;"></td>
                    <td></td>
                    <td style="width:100px;  align-items: right; text-align: right;">Paga con :&nbsp&nbsp</td>
                    <td style="width:100px;  align-items: right; text-align: right;">
                      <input style="width:100px;" align="center" class="btn btn-primary btn-lg btn-block" id="pago"
                        name="pago" class="total" value="" type="text" readonly></input>
                    </td>
                  </tr>
                  <tr>
                    <td colspan=2 style="width:200px;  align-items: center; text-align: center;">
                      <label>Forma de Pago</label><br>
                    </td>
                    <td style="width:500px;" colspan="3">
                      <input style="width:500px;" name="trans" id="trans"></input>
                    </td>
                    <td style="width:100px;  align-items: right; text-align: right;">Su Vuelto :&nbsp&nbsp</td>
                    <td style="width:100px;  align-items: right; text-align: right;">
                      <input style="width:100px;" align="center" class="btn btn-primary btn-lg btn-block" id="vuelto"
                        name="vuelto" class="total" value="" type="text" readonly> </input>
                    </td>
                  </tr>



                  <td style="width:110px;   align-items: right; text-align: right;">
                    <input style="width:120px; height: 150px;  font-size: 2rem;"
                      class="btn btn-success btn-lg btn-block" id="boton" value="Imprimir" onclick=validar()></input>
                  </td>
                  </tr>
                  <input name="caja" id="caja" hidden=true></input>

                  <!--
                <td style="width:300px;  align-items: right; text-align: right;">


                  <input style="width:300px;" class="btn btn-success btn-lg btn-block" id="imprime"
                    value="Imprime ticket" onclick=imprimeTicket() type="button">
                </td>
                -->
                  <tr>
                    <td>
                      <label></label>
                    </td>
                    <td style="width:500px;hight=100px;" colspan="3">
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <label>Notas</label>
                    </td>
                    <td style="width:500px;" colspan="3">
                      <input style="width:500px;" name="nota" id="nota"></input>
                      <input style="width:500px;" name="guardacliente" id="guardacliente" hidden></input>
                      <!-- estos campos son para guardar cliente nuevo los pongo aca porque no me los lee de la ventana modal-->
                      <input type="text" name="nombre" id="nombre" hidden />
                      <input type="text" name="calle" id="calle" hidden />
                      <input type="text" name="localidad" id="localidad" hidden />
                      <input type="text" name="telefono" id="telefono" hidden />
                      <input type="text" name="iva" id="iva" hidden>
                      <input type="text" name="cuit" id="cuit" hidden />
                      <input type="text" name="mail" id="mail" hidden />
                      <input type="text" name="categoria" id="categoria" value="2" hidden />


                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>

        </form>
      </div>

    </div>
  </form>

  <div class="overlay"></div> <!-- si sacoesto deja de andar el scrip -->

  <script type="text/javascript">


    $('#search').keyup(function () {
      search_table($(this).val());
    });

    function search_table(value) {
      console.log("pasa")
      $('#tabla tr').each(function () {
        var found = 'false';

        $(this).each(function () {
          if ($(this).text().toLowerCase().indexOf(value.toLowerCase()) >= 0) {
            found = 'true';
          }
        });

        if (found == 'true') {
          $(this).show();
        }
        else {
          $(this).hide();
        }

      });
    }



    $('.verfactura').on('click', function (e) {
      console.log('verfactura');
      console.log(e.target);
      var id = (e.target.value);
      console.log("id :", id);
      document.getElementById("factura").value = id
      document.getElementById("fecha").value = $("#fecha_" + id).val()
      document.getElementById("hora").value = $("#hora_" + id).val()
      document.getElementById("cliente").value = $("#cliente_" + id).val()
      console.log("vendedor", $("#vendedor_" + id).val())
      document.getElementById("combo_prov").value = $("#vendedor_" + id).val()
      document.getElementById("tipodeventa").value = $("#tipoventa_" + id).val()
      document.getElementById("condicion").value = $("#condicion_" + id).val()
      document.getElementById("total").value = $("#total_" + id).val()
      document.getElementById("cliente_saldo").value = $("#saldoant_" + id).val()
      document.getElementById("trans").value = $("#trans_" + id).val()
      document.getElementById("verticket_remito").submit();

    });

  </script>

</body>
<footer class="oculto-impresion"></footer>